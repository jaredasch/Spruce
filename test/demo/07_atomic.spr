let shared x : int = 0;


func sneakyOtherThread() -> string {
     for (i : int in range(3000)) {
        atomic {
            x = x + 1;
        }
     }
     return "this must be == 6000!";
}


let s1: string = fork(sneakyOtherThread);
let s2: string = fork(sneakyOtherThread);


wait(s1);
wait(s2);

return x;
